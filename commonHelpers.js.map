{"version":3,"file":"commonHelpers.js","sources":["../src/pixabay-api.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '44415141-73aa0910a2180b32b461f4de8';\n\nexport async function serviceImages(searchQuery, itemsPerPage, page) {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: searchQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: itemsPerPage,\n    page,\n  });\n\n  const response = await axios.get(`${BASE_URL}?${params.toString()}`);\n  return response.data;\n}\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\n\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { serviceImages } from './pixabay-api';\n\nconst elements = {\n  searchForm: document.querySelector('.search-form'),\n  gallery: document.querySelector('.gallery'),\n  searchInput: document.querySelector('input[name=\"searchQuery\"]'),\n  searchButton: document.querySelector('button[type=\"submit\"]'),\n};\n\nlet loadedItems = 0;\nlet page = 1;\nconst itemsPerPage = 40;\n\nconst lightbox = new SimpleLightbox('.gallery a', {});\nconst observer = new IntersectionObserver(handlerLoadMore, {\n  root: null,\n  rootMargin: '300px',\n  threshold: 0.3,\n});\n\nfunction handlerLoadMore(entries) {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      loadData();\n    }\n  });\n}\n\nfunction onSearch() {\n  elements.searchButton.disabled = !elements.searchInput.value.trim();\n}\n\nasync function onSubmit(event) {\n  event.preventDefault();\n\n  loadedItems = 0;\n  page = 1;\n  elements.gallery.innerHTML = '';\n\n  await loadData();\n}\n\nasync function loadData() {\n  const inputValue = elements.searchInput.value;\n\n  try {\n    const { hits, totalHits } = await serviceImages(\n      inputValue,\n      itemsPerPage,\n      page\n    );\n\n    if (totalHits === 0) {\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again.',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    if (totalHits > 0 && loadedItems === 0) {\n      iziToast.success({\n        title: 'Success',\n        message: `Hooray! We found ${totalHits} images.`,\n        position: 'topRight',\n      });\n    }\n\n    renderGallery(hits);\n    lightbox.refresh();\n    loadedItems += hits.length;\n    page += 1;\n\n    const items = elements.gallery.querySelectorAll('.photo-card');\n    const itemToObserve = items[items.length - 1];\n    if (itemToObserve) {\n      observer.observe(itemToObserve);\n    }\n\n    if (loadedItems >= totalHits) {\n      observer.disconnect();\n      iziToast.info({\n        title: 'Info',\n        message: 'You have viewed all available images.',\n        position: 'topRight',\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Oops! Something went wrong! Try reloading the page!',\n      position: 'topRight',\n    });\n  }\n}\n\nfunction renderGallery(cards) {\n  const markup = cards\n    .map(\n      ({\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n        largeImageURL,\n        webformatURL,\n      }) => {\n        return `\n        <a href=\"${largeImageURL}\" class=\"card-link\">\n          <div class=\"photo-card\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" class=\"image\" />\n            <div class=\"info\">\n              <p class=\"info-item\">\n                <span><b>Likes</b></span>\n                <span>${likes}</span>\n              </p>\n              <p class=\"info-item\">\n                <span><b>Views</b></span>\n                <span>${views}</span>\n              </p>\n              <p class=\"info-item\">\n                <span><b>Comments</b></span>\n                <span>${comments}</span>\n              </p>\n              <p class=\"info-item\">\n                <span><b>Downloads</b></span>\n                <span>${downloads}</span>\n              </p>\n            </div>\n          </div>\n        </a>`;\n      }\n    )\n    .join('');\n\n  elements.gallery.insertAdjacentHTML('beforeend', markup);\n}\n\nelements.searchForm.addEventListener('submit', onSubmit, false);\nelements.searchInput.addEventListener('input', onSearch, false);\n"],"names":["BASE_URL","API_KEY","serviceImages","searchQuery","itemsPerPage","page","params","axios","elements","loadedItems","lightbox","SimpleLightbox","observer","handlerLoadMore","entries","entry","loadData","onSearch","onSubmit","event","inputValue","hits","totalHits","iziToast","renderGallery","items","itemToObserve","cards","markup","tags","likes","views","comments","downloads","largeImageURL","webformatURL"],"mappings":"owBAEA,MAAMA,EAAW,2BACXC,EAAU,qCAET,eAAeC,EAAcC,EAAaC,EAAcC,EAAM,CACnE,MAAMC,EAAS,IAAI,gBAAgB,CACjC,IAAKL,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUC,EACV,KAAAC,CACJ,CAAG,EAGD,OADiB,MAAME,EAAM,IAAI,GAAGP,CAAQ,IAAIM,EAAO,SAAU,CAAA,EAAE,GACnD,IAClB,CCVA,MAAME,EAAW,CACf,WAAY,SAAS,cAAc,cAAc,EACjD,QAAS,SAAS,cAAc,UAAU,EAC1C,YAAa,SAAS,cAAc,2BAA2B,EAC/D,aAAc,SAAS,cAAc,uBAAuB,CAC9D,EAEA,IAAIC,EAAc,EACdJ,EAAO,EACX,MAAMD,EAAe,GAEfM,EAAW,IAAIC,EAAe,aAAc,CAAE,CAAA,EAC9CC,EAAW,IAAI,qBAAqBC,EAAiB,CACzD,KAAM,KACN,WAAY,QACZ,UAAW,EACb,CAAC,EAED,SAASA,EAAgBC,EAAS,CAChCA,EAAQ,QAAQC,GAAS,CACnBA,EAAM,gBACRC,GAEN,CAAG,CACH,CAEA,SAASC,GAAW,CAClBT,EAAS,aAAa,SAAW,CAACA,EAAS,YAAY,MAAM,MAC/D,CAEA,eAAeU,EAASC,EAAO,CAC7BA,EAAM,eAAc,EAEpBV,EAAc,EACdJ,EAAO,EACPG,EAAS,QAAQ,UAAY,GAE7B,MAAMQ,EAAQ,CAChB,CAEA,eAAeA,GAAW,CACxB,MAAMI,EAAaZ,EAAS,YAAY,MAExC,GAAI,CACF,KAAM,CAAE,KAAAa,EAAM,UAAAC,CAAW,EAAG,MAAMpB,EAChCkB,EACAhB,EACAC,CACN,EAEI,GAAIiB,IAAc,EAAG,CACnBC,EAAS,MAAM,CACb,MAAO,QACP,QACE,2EACF,SAAU,UAClB,CAAO,EACD,MACD,CAEGD,EAAY,GAAKb,IAAgB,GACnCc,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,oBAAoBD,CAAS,WACtC,SAAU,UAClB,CAAO,EAGHE,EAAcH,CAAI,EAClBX,EAAS,QAAO,EAChBD,GAAeY,EAAK,OACpBhB,GAAQ,EAER,MAAMoB,EAAQjB,EAAS,QAAQ,iBAAiB,aAAa,EACvDkB,EAAgBD,EAAMA,EAAM,OAAS,CAAC,EACxCC,GACFd,EAAS,QAAQc,CAAa,EAG5BjB,GAAea,IACjBV,EAAS,WAAU,EACnBW,EAAS,KAAK,CACZ,MAAO,OACP,QAAS,wCACT,SAAU,UAClB,CAAO,EAEJ,MAAe,CACdA,EAAS,MAAM,CACb,MAAO,QACP,QAAS,sDACT,SAAU,UAChB,CAAK,CACF,CACH,CAEA,SAASC,EAAcG,EAAO,CAC5B,MAAMC,EAASD,EACZ,IACC,CAAC,CACC,KAAAE,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,EACA,cAAAC,EACA,aAAAC,CACR,IACe;AAAA,mBACID,CAAa;AAAA;AAAA,wBAERC,CAAY,UAAUN,CAAI;AAAA;AAAA;AAAA;AAAA,wBAI1BC,CAAK;AAAA;AAAA;AAAA;AAAA,wBAILC,CAAK;AAAA;AAAA;AAAA;AAAA,wBAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,wBAIRC,CAAS;AAAA;AAAA;AAAA;AAAA,aAM5B,EACA,KAAK,EAAE,EAEVzB,EAAS,QAAQ,mBAAmB,YAAaoB,CAAM,CACzD,CAEApB,EAAS,WAAW,iBAAiB,SAAUU,EAAU,EAAK,EAC9DV,EAAS,YAAY,iBAAiB,QAASS,EAAU,EAAK"}